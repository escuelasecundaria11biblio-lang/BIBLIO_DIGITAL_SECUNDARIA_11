<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Biblioteca Digital - Fichas guardadas</title>

  <!-- Librer칤a html2pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <style>

  
    .navbar {
      width: 100%;
      background-color: #0e0955;
      color: white;
      padding: 15px 0;
      text-align: center;
      position: fixed;
      top: 0;
      left: 0;
      height: 7%;
      z-index: 1000;
    }
    
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      padding: 20px;
      background: #ffffff;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 30px;
    }

    .filtro {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-right: 270px;
      margin-bottom: 25px;
      margin-top: -90px;
    }

    .filtro input,
    .filtro button {
      padding: 10px;
      font-size: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    .filtro button {
      background-color: #007bff;
      color: white;
      cursor: pointer;
      transition: background 0.3s;
    }

    .filtro button:hover {
      background-color: #0056b3;
    }

    #contenedorFichas {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 20px;
      margin-top: 70px;
    }

    .ficha {
      border: 2px solid #007bff;
      padding: 15px;
      border-radius: 10px;
      background-color: #f8f9fa;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s;
      position: relative;
    }

    .ficha:hover {
      transform: scale(1.02);
    }

    .ficha h3 {
      margin-top: 0;
      color: #007bff;
    }

    hr {
      border: none;
      border-top: 1px solid #ccc;
      margin: 10px 0;
    }

    .btn-eliminar {
      display: inline-block;
      margin-top: 10px;
      padding: 8px 12px;
      background-color: #dc3545;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .btn-eliminar:hover {
      background-color: #b02a37;
    }

    
/* 游댳 Responsive para celulares */
@media (max-width: 768px) {
  body {
    padding: 10px;
  }

  .navbar {
    height: 35px;
    padding: 10px 5px;
    font-size: 16px;
  }

  .filtro {
    display: flex;
    flex-wrap: wrap;
    flex-direction: column;
    align-items: flex-start;
    justify-content: flex-start;
    gap: 8px;

    /* 游댲 Subimos el filtro m치s arriba */
    margin-top: -40px;   /* antes estaba -120px */
    margin-left: 10px;
  }

  .filtro label {
    font-size: 14px;
  }

  .filtro input {
    width: 100%;
    max-width: 220px;
    font-size: 14px;
  }

  .filtro button {
    width: auto;
    padding: 8px 12px;
    font-size: 14px;
    margin-top: 5px;
    margin-left: 0;
  }

  #contenedorFichas {
    grid-template-columns: 1fr;
    gap: 15px;
    margin-top: 30px;  /* un poco m치s cerca del filtro */
    margin-left: 10px;
  }

  .ficha {
    padding: 10px;
    font-size: 14px;
    width: 95%;
  }

  .ficha h3 {
    font-size: 16px;
  }

  .btn-eliminar {
    padding: 6px 10px;
    font-size: 13px;
  }

  .botones {
    margin-top: -120px;
    margin-left: 160px;
  }
}


/* 游댳 Mejoras extra para pantallas muy peque침as */
@media (max-width: 480px) {
  .filtro {
    margin-top: -20px; /* 游댲 a칰n m치s arriba para celulares chicos */
  }

  .filtro input,
  .filtro button,
  .filtro label {
    font-size: 13px;
  }

  .ficha {
    padding: 8px;
  }

  .ficha h3 {
    font-size: 15px;
  }

  .btn-eliminar {
    padding: 5px 8px;
    font-size: 12px;
  }

  #filtro_fichas{
    margin-top: 165px;
    margin-left: -160px;
  }

  #imprimir_fichas{

    width: 120px;

  }

  #guarda_pdf {
    width: 140px;
    margin-left: 65px;
    position: relative; /* 游댳 activar top/bottom */
    top: -40px;         /* 游댳 mover hacia arriba */
  }

  #filtroMes{
    margin-left: 150px;
    margin-top: -30px;
  }

  #filtrar_por_mes{
    margin-left: 160px;
    margin-top: -72px;
    
  }
}

  </style>
</head>
<body>

  <div class="navbar">
    <span class="navbar-text">E.E.S N춿11</span>
  </div>

    <img src="imagenes/escudo_11.png" id="escudo_11" style="width: 12%; height: 20%; margin-left: 84%; margin-top: 40px;" />


  <div class="filtro">
    <label>Filtrar por d칤a:</label>
    <input type="date" id="filtroFecha" />
    <label id="filtrar_por_mes">Filtrar por mes:</label>
    <input type="month" id="filtroMes" />

    <div class="botones">
      <button onclick="filtrarFichas()" id="filtro_fichas">Filtrar fichas</button>
      <button onclick="imprimirFichas()" id="imprimir_fichas">Imprimir fichas</button>
      <button onclick="guardarComoPDF()" id="guarda_pdf">Guardar como PDF</button>
    </div>
    
  </div>

  <div id="contenedorFichas"></div>

  <script>
    const contenedor = document.getElementById("contenedorFichas");
    let fichas = JSON.parse(localStorage.getItem("fichas_retiro")) || [];
    let fichasFiltradas = fichas;

    function mostrarFichas(fichasMostrar) {
      contenedor.innerHTML = "";
      if (fichasMostrar.length === 0) {
        contenedor.innerHTML = "<p>No hay fichas guardadas.</p>";
      } else {
        fichasMostrar.forEach((ficha, i) => {
          const div = document.createElement("div");
          div.className = "ficha";
          div.innerHTML = `
            <h3>Ficha #${i + 1}</h3>
            <p><strong>Fecha:</strong> ${ficha.fecha}</p>
            <p><strong>Alumno:</strong> ${ficha.alumno["APELLIDO Y NOMBRES"]}</p>
            <p><strong>DNI:</strong> ${ficha.alumno["N춿 DE DNI"]}</p>
            <p><strong>Curso:</strong> ${ficha.alumno.CURSO} - Turno: ${ficha.alumno.TURNO}</p>
            <p><strong>Domicilio:</strong> ${ficha.alumno.DOMICILIO}</p>
            <hr>
            <p><strong>Libro:</strong> ${ficha.libro.titulo}</p>
            <p><strong>Autor:</strong> ${ficha.libro.autor}</p>
            <p><strong>Editorial:</strong> ${ficha.libro.editorial}</p>
            <p><strong>Materia:</strong> ${ficha.libro.materia}</p>
            <p><strong>Inventario:</strong> ${ficha.libro.inventario}</p>
            <button class="btn-eliminar" onclick="eliminarFicha(${i})">Eliminar ficha</button>
          `;
          contenedor.appendChild(div);
        });
      }
    }

    function filtrarFichas() {
      const fechaSeleccionada = document.getElementById("filtroFecha").value;
      const mesSeleccionado = document.getElementById("filtroMes").value;

      fichasFiltradas = fichas.filter((f) => {
        const fechaFicha = f.fecha;
        const coincideDia = fechaSeleccionada
          ? fechaFicha === fechaSeleccionada
          : true;
        const coincideMes = mesSeleccionado
          ? fechaFicha.startsWith(mesSeleccionado)
          : true;
        return coincideDia && coincideMes;
      });

      mostrarFichas(fichasFiltradas);
    }

    function imprimirFichas() {
      if (fichasFiltradas.length === 0) {
        alert("No hay fichas para imprimir.");
        return;
      }
      window.print();
    }

    function guardarComoPDF() {
      if (fichasFiltradas.length === 0) {
        alert("No hay fichas para guardar en PDF.");
        return;
      }

      const element = document.getElementById("contenedorFichas");
      const opciones = {
        margin: 0.5,
        filename: "fichas_filtradas.pdf",
        image: { type: "jpeg", quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: "in", format: "letter", orientation: "portrait" },
      };
      html2pdf().set(opciones).from(element).save();
    }

    function eliminarFicha(index) {
      if (confirm("쮼st치s seguro de eliminar esta ficha?")) {
        fichas.splice(index, 1);
        localStorage.setItem("fichas_retiro", JSON.stringify(fichas));
        filtrarFichas();
      }
    }

    mostrarFichas(fichas);
  </script>

<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>P치gina protegida</title>
<style>
  /* Modal b치sico */
  #authModal {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(0,0,0,0.6);
    z-index: 9999;
  }

  #authModalContent {
    background: #fff;
    padding: 25px 20px;
    border-radius: 10px;
    text-align: center;
    max-width: 400px;
    width: 90%;
  }

  #authModalContent input {
    width: 96%;
    padding: 10px;
    margin-top: 8px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 16px;
  }

  #authModalContent button {
    margin-top: 12px;
    padding: 8px 16px;
    border: none;
    background-color: #0e0955;
    color: white;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
  }

  #authMsg {
    margin-top: 8px;
    color: #b02a37;
    min-height: 18px;
  }
</style>
</head>
<body>

<script>
(function(){
  const PASSWORD = "ROBLIGADO25";

  // Crear modal
  const modal = document.createElement("div");
  modal.id = "authModal";
  modal.innerHTML = `
    <div id="authModalContent">
      <h3>Acceso restringido</h3>
      <p>Introduce la contrase침a:</p>
      <input type="password" id="authInput" />
      <div>
        <button id="authBtn">Ingresar</button>
      </div>
      <div id="authMsg"></div>
    </div>
  `;
  document.body.appendChild(modal);

  const input = modal.querySelector("#authInput");
  const btn = modal.querySelector("#authBtn");
  const msg = modal.querySelector("#authMsg");

  function tryLogin() {
    if(input.value.trim() === PASSWORD){
      modal.style.display = "none";
    } else {
      msg.textContent = "Contrase침a incorrecta";
      input.value = "";
      input.focus();
    }
  }

  btn.addEventListener("click", tryLogin);
  input.addEventListener("keydown", (e)=>{
    if(e.key === "Enter") tryLogin();
  });

})();
</script>
</body>
</html>
</body>
</html>
